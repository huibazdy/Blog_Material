## 相似度度量（Similatiry Scoring）

相似度度量的原理是利用一个函数来判断两个音频嵌入码是否具有一致性。

输入：分别是运行时录入得到的和训练时用户录入的声纹档案，可以分别表征为两个向量，分别是：

* 运行时音频特征：$\mathbf {e_1}$
* 运行前用户录入的声纹特征：$\mathbf {e_2}$

### 余弦相似度

计算两个向量在欧式空间中的夹角，分子是向量内积，分母是两个向量的 L2 范数乘积：

越大与相似。

### 欧氏距离

对两向量的差再取 L2 范数得到：

然后再对其取倒数。

越小越相似。

> 注意：
>
> 余弦相似度与向量长度无关，因为分母中有 L2 范数，相当于是单位向量。但欧氏距离是和限量长度相关的。



### 基于模型的相似度量

前面两种打分机制都是没有任何参数的，只和输入特征向量有关。除此之外还有另外的一种打分情况，那就是基于**可变参数**模型的相似度量。

简而言之：就是用一个带参数向量（$\boldsymbol\theta$）的函数来进行打分，输入变量还是两个向量。
$$
\boldsymbol{f}\,(\bold{e_1},\bold{e_1}\,|\,\boldsymbol{\theta})
$$
这里的 $\boldsymbol{f}(\bold{\cdot})$一般指的就是 AI 模型。可能是 ML ，也可能是一个 ANN 。注意，此处的神经网络一般称为**决策网络**（**Decision Network**）。

> 怎样理解参数向量 $\boldsymbol\theta$ ？

例如此处的 $\boldsymbol{f}(\bold{\cdot})$ 是一个简单的多项式，那么这个多项式的系数就组成了参数向量 $\boldsymbol\theta$ 。如果模型比较复杂，例如一个神经网络，那么 $\boldsymbol\theta$ 就是一个神经网络的参数（权重weights、偏差bias等）。

$\boldsymbol\theta$ 是由训练数据得到的参数向量。



> 基于模型的相似度量的变种——**Dr-Vectors**

融合了余弦相似度和神经网络两种相似度度量方式，然后将二者的分数相加。

* 余弦相似度使用了整个声纹嵌入码
* 决策网络只使用了声纹嵌入码的一部分维度

这种变种相似度度量方法保留了两种方式的优势。



## 决策（Thresholding）

设定阈值 T ，当相似性度量不小于 T 认为声纹时匹配的。可以分为三种应用情况：

* low threshold：直接冻结
* medium threshold：拒绝后，允许充重试
* high threshold：直接接受



## 评价

> 如何评价一个声纹识别系统的好坏？

例如有两个声纹识别系统 A 和 B，需要保证一些评价变量的一致性：

1. 测试集
2. 指标
3. 测试流程

总的来说有两种评价方式：

1. 基于语音对——Pair-Based
2. 基于集合——Set-Based



### 构建测试集

构建测试集需要保证以下几点要求：

1. 出现在训练集中的数据都不能再出现在测试集中；
2. 出现在训练集中的说话人都不能再出现在测试集中



### Pair-Based

由多组 trial pair 组成的一个 list 。每一个 trial pair 包含：

1. 两段音频（two utterances）：可能来自于同一说话人，也可能来自不同说话人。用一个标志位（0表示来自不同说话人，1表示来自相同说话人）来标记。

参考 **VoxCeleb** 数据集中 standard trial pairs 。

相当于一段音频是提前录入的 enrollment ，另一段是运行时录入的实时音频。

### Set-Based

实际情况中，可能有多个 enrollment （录入语音）。所以有时候需要基于集合的评价指标。实际做法是：

1. 将数据集划分为两个子集（录入数据集enrollment set 和验证数据集 verification set）